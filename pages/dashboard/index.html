<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Admin - Dunia Digital</title>
<link rel="stylesheet" href="../../assets/css/style.css">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#020617;
  color:#fff;
}
.container{
  max-width:1200px;
  margin:auto;
  padding:20px;
}
h1{
  color:#22c55e;
  margin-bottom:20px;
}
.login-box{
  max-width:400px;
  margin:120px auto;
  background:#020617;
  padding:30px;
  border-radius:16px;
  text-align:center;
  box-shadow:0 10px 40px rgba(0,0,0,0.6);
}
input{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:10px;
}
button{
  margin-top:15px;
  padding:12px 20px;
  border:none;
  border-radius:10px;
  font-weight:bold;
  background:linear-gradient(45deg,#22c55e,#16a34a);
  color:white;
  cursor:pointer;
}
button:hover{
  background:linear-gradient(45deg,#16a34a,#22c55e);
}
.table-box{
  overflow-x:auto;
  background:#020617;
  border-radius:16px;
  padding:20px;
  box-shadow:0 10px 40px rgba(0,0,0,0.6);
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:12px;
  text-align:left;
  border-bottom:1px solid #1e293b;
}
th{
  color:#22c55e;
}
.search{
  margin-bottom:15px;
  padding:10px;
  width:100%;
  border-radius:10px;
  border:none;
}
.actions button{
  padding:6px 12px;
  font-size:12px;
  margin-right:5px;
}
.logout{
  float:right;
}
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage" class="login-box">
  <h2>Login Admin</h2>
  <input type="password" id="password" placeholder="Masukkan Password Admin">
  <button onclick="login()">Masuk Dashboard</button>
</div>

<!-- DASHBOARD -->
<div id="dashboardPage" style="display:none">
  <div class="container">
    <div class="topbar">
      <h1>Dashboard Order Ebook</h1>
      <button class="logout" onclick="logout()">Logout</button>
    </div>

    <input type="text" class="search" placeholder="Cari nama / produk..." onkeyup="searchOrders(this.value)">

    <div class="table-box">
      <table>
        <thead>
          <tr>
            <th>Nama</th>
            <th>Email</th>
            <th>Produk</th>
            <th>Tanggal</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="orderTable"></tbody>
      </table>
    </div>

    <button onclick="exportCSV()">Export CSV</button>
  </div>
</div>

<script>
// PASSWORD ADMIN (ubah kalau mau)
const ADMIN_PASS = "123456";

// LOGIN
function login(){
  const pass = document.getElementById("password").value;
  if(pass === ADMIN_PASS){
    localStorage.setItem("admin_login","true");
    showDashboard();
  }else{
    alert("Password salah!");
  }
}

// LOGOUT
function logout(){
  localStorage.removeItem("admin_login");
  location.reload();
}

// CEK LOGIN
function checkLogin(){
  if(localStorage.getItem("admin_login") === "true"){
    showDashboard();
  }
}

function showDashboard(){
  document.getElementById("loginPage").style.display="none";
  document.getElementById("dashboardPage").style.display="block";
  loadOrders();
}

// LOAD ORDER DARI LOCALSTORAGE
function loadOrders(){
  const orders = JSON.parse(localStorage.getItem("orders") || "[]");
  const table = document.getElementById("orderTable");
  table.innerHTML = "";

  orders.forEach((o,i)=>{
    table.innerHTML += `
      <tr>
        <td>${o.nama}</td>
        <td>${o.email}</td>
        <td>${o.produk}</td>
        <td>${o.tanggal}</td>
        <td class="actions">
          <button onclick="deleteOrder(${i})">Hapus</button>
        </td>
      </tr>
    `;
  });
}

// HAPUS ORDER
function deleteOrder(index){
  let orders = JSON.parse(localStorage.getItem("orders") || "[]");
  if(confirm("Hapus order ini?")){
    orders.splice(index,1);
    localStorage.setItem("orders",JSON.stringify(orders));
    loadOrders();
  }
}

// SEARCH
function searchOrders(keyword){
  const rows = document.querySelectorAll("#orderTable tr");
  rows.forEach(row=>{
    row.style.display = row.innerText.toLowerCase().includes(keyword.toLowerCase()) ? "" : "none";
  });
}

// EXPORT CSV
function exportCSV(){
  const orders = JSON.parse(localStorage.getItem("orders") || "[]");
  let csv = "Nama,Email,Produk,Tanggal\n";
  orders.forEach(o=>{
    csv += `${o.nama},${o.email},${o.produk},${o.tanggal}\n`;
  });

  const blob = new Blob([csv], {type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "orders.csv";
  a.click();
}

// AUTO LOAD
checkLogin();
</script>

</body>
</html>
